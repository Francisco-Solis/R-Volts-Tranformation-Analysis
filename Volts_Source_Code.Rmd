---
title: "Volts Dataset Analysis with Transformation"
author: "Francisco Solis"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```



##

**Capacitor voltage**. A capacitor was charged with a 9-volt battery and then a voltmeter recorded the voltage as the capacitor was discharged. Measurements were taken every 0.02 second. The data are in the file Volts.

Objectives a,b,c,d,e,f

(a) Create a scatter plot of Voltage vs Time.
(b) Fit a SLR to predict Voltage from Time, with its summary. 
(c) Display diagnostic plots for checking conditions
    - the residual vs fitted  
    - Normal Q-Q 
(d) Transform Voltage using a log transformation and create scatter plot of transformed model.
(e) Fit a SLR to predict log(Voltage) from Time, with its summary of the model.
(f) Display diagnostic plots for checking conditions of transformed model
    - the residual vs fitted
    - Normal Q-Q 
(g) Check for any outliers and or influential points via Cook's Distance and Residuals vs Leverage plots

    

```{r volts}
library(Stat2Data)

# Summary of first 5 rows of data
data("Volts")
head(Volts, n=5)

# (a) ggplot to form the scatterplot
library(ggplot2)

ggplot(Volts, aes(x = Time, y = Voltage)) +
  geom_point() +
  labs(title = "Voltage vs Time",
       x = "Time (s)",
       y = "Voltage (v)")


# (b) Fitting of a simple linear regression model and its summary

SLR <- lm(Voltage ~ Time, data = Volts)
summary(SLR)

# (c) Residual vs Fitted plot and QQ plot
par(mfrow=c(1,2))
plot(SLR,which=1:2) 
par(mfrow=c(1,1)) 

# (d) Log-transformation of Y into new scatter plot
library(dplyr)
volts2 = mutate(Volts,logVoltage=log(Voltage))

ggplot(volts2, aes(x = Time, y = logVoltage)) +
  geom_point() +
  labs(title = "log(Voltage) vs Time",
       x = "Time (s)",
       y = "Voltage (v)") 

# (e) Refitting of simple linear regression model to the log-transformed Y
SLR2 <- lm(logVoltage ~ Time, data = volts2)
summary(SLR2)

# (f) Residual vs Fitted and QQ plot on the transformed Y.
par(mfrow=c(1,2))
plot(SLR2,which=1:2) 
par(mfrow=c(1,1)) 

# (g) Cook's distance and Residuals vs Leverage plots
par(mfrow=c(1,2))
plot(SLR2,which=4:5)

```






